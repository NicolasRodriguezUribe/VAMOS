============================= test session starts =============================
platform win32 -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: C:\Users\nicor\Desktop\VAMOS
configfile: pyproject.toml
plugins: cov-7.0.0
collected 2 items

tests\engine\test_parallel_tuning.py F.                                  [100%]

================================== FAILURES ===================================
____________________________ test_parallel_speedup ____________________________

    def test_parallel_speedup():
        """
        Verify that n_jobs > 1 allows parallel execution.
        We'll evaluate 10 configs.
        Sequential: 10 * 0.05 = 0.5s.
        Parallel (2 jobs): ~0.25s.
        """
        param_space = ParamSpace({"x": Real("x", 0.0, 1.0)})
        instances = [Instance("inst1", 1)]
        seeds = [0]
    
        task = TuningTask(
            name="test_parallel",
            param_space=param_space,
            instances=instances,
            seeds=seeds,
            budget_per_run=1,
            maximize=False
        )
    
        # 1. Sequential Run
        scenario_seq = Scenario(
            max_experiments=20,
            n_jobs=1,
            verbose=False,
            start_instances=1,
            elimination_fraction=0.1
        )
        tuner_seq = RacingTuner(task, scenario_seq, max_initial_configs=8)
    
        start = time.time()
        tuner_seq.run(slow_eval_fn)
        dur_seq = time.time() - start
    
        # 2. Parallel Run
        scenario_par = Scenario(
            max_experiments=20,
            n_jobs=2,
            verbose=False,
            start_instances=1,
            elimination_fraction=0.1
        )
        tuner_par = RacingTuner(task, scenario_par, max_initial_configs=8)
    
        start = time.time()
        tuner_par.run(slow_eval_fn)
        dur_par = time.time() - start
    
        # Expect parallel to be faster
        # Note: Overhead might eat gains for such small sleep, but 0.05 * 8 = 0.4s is huge compared to overhead.
        # Parallel should be around 0.2s + overhead.
        # Let's assess if it's at least faster.
    
        print(f"Sequential: {dur_seq:.4f}s")
        print(f"Parallel: {dur_par:.4f}s")
    
        # Relaxed assertion to account for potential test env noise/overhead
        # But usually parallel should be significantly faster here.
>       assert dur_par < dur_seq
E       assert 1.1096019744873047 < 0.40398192405700684

tests\engine\test_parallel_tuning.py:76: AssertionError
---------------------------- Captured stdout call -----------------------------
Sequential: 0.4040s
Parallel: 1.1096s
=========================== short test summary info ===========================
FAILED tests/engine/test_parallel_tuning.py::test_parallel_speedup - assert 1...
========================= 1 failed, 1 passed in 2.67s =========================
